#pragma once
#include <unordered_set>
#include <string>

static const std::unordered_set<std::wstring> g_forcedSignedPaths = {
    // SYSTEM32
    L"\\WINDOWS\\SYSTEM32\\RUNDLL32.EXE",
    L"\\WINDOWS\\SYSTEM32\\USERINIT.EXE",
    L"\\WINDOWS\\SYSTEM32\\REGSVR32.EXE",
    L"\\WINDOWS\\SYSTEM32\\DXDIAG.EXE",
    L"\\WINDOWS\\SYSTEM32\\POWERCFG.EXE",
    L"\\WINDOWS\\SYSTEM32\\CHCP.COM",
    L"\\WINDOWS\\SYSTEM32\\CHOICE.EXE",
    L"\\WINDOWS\\SYSTEM32\\TIMEOUT.EXE",
    L"\\WINDOWS\\SYSTEM32\\LOGONUI.EXE",
    L"\\WINDOWS\\SYSTEM32\\ATBROKER.EXE",
    L"\\WINDOWS\\SYSTEM32\\WHERE.EXE",
    L"\\WINDOWS\\SYSTEM32\\WBEM\\WMIAPSRV.EXE",
    L"\\WINDOWS\\SYSTEM32\\SC.EXE",
    L"\\WINDOWS\\SYSTEM32\\REG.EXE",
    L"\\WINDOWS\\SYSTEM32\\WINDOWSPOWERSHELL\\V1.0\\POWERSHELL.EXE",
    L"\\WINDOWS\\SYSTEM32\\CMD.EXE",
    L"\\WINDOWS\\SYSTEM32\\CONHOST.EXE",
    L"\\WINDOWS\\SYSTEM32\\LOCALE.NLS",
    L"\\WINDOWS\\SYSTEM32\\UXTHEME.DLL",
    L"\\WINDOWS\\SYSTEM32\\RPCSS.DLL",
    L"\\WINDOWS\\SYSTEM32\\USERINITEXT.DLL",
    L"\\WINDOWS\\SYSTEM32\\NOTEPAD.EXE",
    L"\\WINDOWS\\SYSTEM32\\OSK.EXE",
    L"\\WINDOWS\\SYSTEM32\\TASKLIST.EXE",
    L"\\WINDOWS\\SYSTEM32\\SEARCHFILTERHOST.EXE",
    L"\\WINDOWS\\SYSTEM32\\L_INTL.NLS",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\RUNDLL32.EXE.MUI",
    L"\\WINDOWS\\SYSTEM32\\C_1252.NLS",
    L"\\WINDOWS\\SYSTEM32\\C_437.NLS",
    L"\\WINDOWS\\SYSTEM32\\CTFMON.EXE",
    L"\\WINDOWS\\SYSTEM32\\MSCTFMONITOR.DLL",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\CTFMON.EXE.MUI",
    L"\\WINDOWS\\SYSTEM32\\MTFSERVER.DLL",
    L"\\WINDOWS\\SYSTEM32\\INPUTLOCALEMANAGER.DLL",
    L"\\WINDOWS\\SYSTEM32\\KBDSP.DLL",
    L"\\WINDOWS\\SYSTEM32\\KBDLA.DLL",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\DATAMAP.0409.DAT",
    L"\\WINDOWS\\SYSTEM32\\WIN32KFULL.SYS",
    L"\\WINDOWS\\SYSTEM32\\WBEM\\WMIPRVSE.EXE",
    L"\\WINDOWS\\SYSTEM32\\WBEM\\WMIUTILS.DLL",
    L"\\WINDOWS\\SYSTEM32\\WIN32_DEVICEGUARD.DLL",
    L"\\WINDOWS\\SYSTEM32\\SMARTSCREEN.EXE",
    L"\\WINDOWS\\SYSTEM32\\NCOBJAPI.DLL",
    L"\\WINDOWS\\SYSTEM32\\WBEM\\FASTPROX.DLL",
    L"\\WINDOWS\\SYSTEM32\\WBEMCOMN.DLL",
    L"\\WINDOWS\\SYSTEM32\\WBEM\\WBEMPROX.DLL",
    L"\\WINDOWS\\SYSTEM32\\WMITOMI.DLL",
    L"\\WINDOWS\\SYSTEM32\\FRAMEDYNOS.DLL",
    L"\\WINDOWS\\SYSTEM32\\TZRES.DLL",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\TZRES.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\SAMCLI.DLL",
    L"\\WINDOWS\\SYSTEM32\\SCHEDCLI.DLL",
    L"\\WINDOWS\\SYSTEM32\\SECURITY.DLL",
    L"\\WINDOWS\\SYSTEM32\\SECUR32.DLL",
    L"\\WINDOWS\\SYSTEM32\\CSCAPI.DLL",
    L"\\WINDOWS\\SYSTEM32\\WBEM\\EN-US\\CIMWIN32.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\WBEM\\WMIPCIMA.DLL",
    L"\\WINDOWS\\SYSTEM32\\WBEM\\NETADAPTERCIM.DLL",
    L"\\WINDOWS\\SYSTEM32\\LSM.DLL",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\LSM.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\HVHOSTSVC.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\DRIVERS\\EN-US\\PACER.SYS.MUI",
    L"\\WINDOWS\\SYSTEM32\\FWPUCLNT.DLL",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\FWPUCLNT.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\AZROLES.DLL",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\AZROLES.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\FXSRESM.DLL",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\FXSRESM.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\LSASRV.DLL",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\LSASRV.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\DRIVERS\\EN-US\\AFD.SYS.MUI",
    L"\\WINDOWS\\SYSTEM32\\DRIVERS\\EN-US\\FVEVOL.SYS.MUI",
    L"\\WINDOWS\\SYSTEM32\\DRIVERS\\EN-US\\SPACEPORT.SYS.MUI",
    L"\\WINDOWS\\SYSTEM32\\DRIVERS\\EN-US\\REFS.SYS.MUI",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\MISPACE.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\DRIVERS\\EN-US\\TCPIP.SYS.MUI",
    L"\\WINDOWS\\SYSTEM32\\IPHLPSVC.DLL",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\IPHLPSVC.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\DRIVERS\\EN-US\\DMVSC.SYS.MUI",
    L"\\WINDOWS\\SYSTEM32\\BTHSERV.DLL",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\BTHSERV.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\DRIVERS\\EN-US\\VHDMP.SYS.MUI",
    L"\\WINDOWS\\SYSTEM32\\UMPOEXT.DLL",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\UMPOEXT.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\DRIVERS\\EN-US\\WINNAT.SYS.MUI",
    L"\\WINDOWS\\SYSTEM32\\DRIVERS\\EN-US\\HTTP.SYS.MUI",
    L"\\WINDOWS\\SYSTEM32\\WINDOWSPOWERSHELL\\V1.0\\PSEVENTS.DLL",
    L"\\WINDOWS\\SYSTEM32\\WINDOWSPOWERSHELL\\V1.0\\EN-US\\PSEVENTS.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\WBEM\\WINMGMTR.DLL",
    L"\\WINDOWS\\SYSTEM32\\WBEM\\EN-US\\WINMGMTR.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\WMP.DLL",
    L"\\WINDOWS\\SYSTEM32\\RDPCORETS.DLL",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\RDPCORETS.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\DRIVERS\\SRV2.SYS",
    L"\\WINDOWS\\SYSTEM32\\DRIVERS\\EN-US\\SRV2.SYS.MUI",
    L"\\WINDOWS\\SYSTEM32\\REFSDEDUPSVC.EXE",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\REFSDEDUPSVC.EXE.MUI",
    L"\\WINDOWS\\SYSTEM32\\NETLOGON.DLL",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\NETLOGON.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\DRIVERS\\EN-US\\USBXHCI.SYS.MUI",
    L"\\WINDOWS\\SYSTEM32\\W32TIME.DLL",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\W32TIME.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\WECSVC.DLL",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\WECSVC.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\DRIVERS\\EN-US\\MRXSMB.SYS.MUI",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\WEVTSVC.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\TASKMGR.EXE.MUI",
    L"\\WINDOWS\\SYSTEM32\\WSMRES.DLL",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\WSMRES.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\VID.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\DRIVERS\\EN-US\\NTFS.SYS.MUI",
    L"\\WINDOWS\\SYSTEM32\\MPRDDM.DLL",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\MPRDDM.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\LOGONCLI.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\WLDAP32.DLL",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\WLDAP32.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\PERFOS.DLL",
    L"\\WINDOWS\\SYSTEM32\\DOMGMT.DLL",
    L"\\WINDOWS\\SYSTEM32\\WINCORLIB.DLL",
    L"\\WINDOWS\\SYSTEM32\\COMPPKGSRV.EXE",
    L"\\WINDOWS\\SYSTEM32\\EN-US\\KERNELBASE.DLL.MUI",
    L"\\WINDOWS\\SYSTEM32\\SECURITYHEALTHSYSTRAY.EXE",
    L"\\WINDOWS\\SYSTEM32\\SIHOST.EXE",
    L"\\WINDOWS\\SYSTEM32\\DESKTOPSHELLEXT.DLL",
    L"\\WINDOWS\\SYSTEM32\\GAMEMODE.DLL",
    L"\\WINDOWS\\SYSTEM32\\MDMREGISTRATION.DLL",
    L"\\WINDOWS\\GLOBALIZATION\\SORTING\\SORTDEFAULT.NLS",
    L"\\WINDOWS\\SYSTEM32\\FCON.DLL",
    L"\\WINDOWS\\SYSTEM32\\CLIPBOARDSERVER.DLL",
    L"\\WINDOWS\\SYSTEM32\\ACTIVATIONMANAGER.DLL",
    L"\\WINDOWS\\SYSTEM32\\APPOINTMENTACTIVATION.DLL",
    L"\\WINDOWS\\SYSTEM32\\MODERNEXECSERVER.DLL",
    L"\\WINDOWS\\SYSTEM32\\USERMGRPROXY.DLL",
    L"\\WINDOWS\\SYSTEM32\\WINDOWMANAGEMENT.DLL",
    L"\\WINDOWS\\SYSTEM32\\NOTIFICATIONPLATFORMCOMPONENT.DLL",
    L"\\WINDOWS\\SYSTEM32\\PACKAGESTATECHANGEHANDLER.DLL",
    L"\\WINDOWS\\SYSTEM32\\EXECMODELPROXY.DLL",
    L"\\WINDOWS\\SYSTEM32\\UIAMANAGER.DLL",
    L"\\WINDOWS\\SYSTEM32\\SHAREHOST.DLL",
    L"\\WINDOWS\\SYSTEM32\\TWINUI.APPCORE.DLL",
    L"\\WINDOWS\\SYSTEM32\\DAXEXEC.DLL",
    L"\\WINDOWS\\SYSTEM32\\CONTAINER.DLL",
    L"\\WINDOWS\\SYSTEM32\\MSSRCH.DLL",
    L"\\WINDOWS\\SYSTEM32\\SEARCHINDEXERCORE.DLL",
    L"\\WINDOWS\\SYSTEM32\\TQUERY.DLL",
    L"\\WINDOWS\\SYSTEM32\\CORESHELLEXTFRAMEWORK.DLL",
    L"\\WINDOWS\\SYSTEM32\\TWINUI.PCSHELL.DLL",
    L"\\WINDOWS\\SYSTEM32\\UIAUTOMATIONCORE.DLL",
    L"\\WINDOWS\\SYSTEM32\\ACTIVATIONCLIENT.DLL",
    L"\\WINDOWS\\SYSTEM32\\WINDOWSUDK.SHELLCOMMON.DLL",
    L"\\WINDOWS\\SYSTEM32\\WINBIOEXT.DLL",
    L"\\WINDOWS\\SYSTEM32\\WINBIO.DLL",
    L"\\WINDOWS\\SYSTEM32\\SHELLHOST.EXE",
    L"\\WINDOWS\\SYSTEM32\\WINDOWS.STORAGE.SEARCH.DLL",
    L"\\WINDOWS\\SYSTEM32\\EDPUTIL.DLL",
    L"\\WINDOWS\\SYSTEM32\\INTEGRATEDSERVICESREGIONPOLICYSET.JSON",
    L"\\WINDOWS\\SYSTEM32\\WINDOWS.WEB.DLL",
    L"\\WINDOWS\\SYSTEM32\\LICENSEMANAGERAPI.DLL",
    L"\\WINDOWS\\SYSTEM32\\URLMON.DLL",
    L"\\WINDOWS\\SYSTEM32\\MSSPRXY.DLL",
    L"\\WINDOWS\\SYSTEM32\\SEARCHPROTOCOLHOST.EXE",
    L"\\WINDOWS\\SYSTEM32\\LPKSETUP.EXE",
    L"\\WINDOWS\\SYSTEM32\\VSSVC.EXE",
    L"\\WINDOWS\\SYSTEM32\\SRTASKS.EXE",
    L"\\WINDOWS\\SYSTEM32\\FODHELPER.EXE",
    L"\\WINDOWS\\SYSTEM32\\DEFRAG.EXE",
    L"\\WINDOWS\\SYSTEM32\\FINDSTR.EXE",
    L"\\WINDOWS\\SYSTEM32\\GAMEBARPRESENCEWRITER.EXE",
    L"\\WINDOWS\\SYSTEM32\\NET.EXE",
    L"\\WINDOWS\\SYSTEM32\\NET1.EXE",
    L"\\WINDOWS\\SYSTEM32\\WEVTUTIL.EXE",
    L"\\WINDOWS\\SYSTEM32\\LAUNCHTM.EXE",
    L"\\WINDOWS\\SYSTEM32\\CONTROL.EXE",
    L"\\WINDOWS\\SYSTEM32\\MMC.EXE",
    L"\\WINDOWS\\SYSTEM32\\WUDFHOST.EXE",
    L"\\WINDOWS\\SYSTEM32\\TASKKILL.EXE",
    L"\\WINDOWS\\SYSTEM32\\SYSTEMPROPERTIESPROTECTION.EXE",
    L"\\WINDOWS\\SYSTEM32\\SETHC.EXE",
    L"\\WINDOWS\\SYSTEM32\\SCHHG.EXE",
    L"\\WINDOWS\\SYSTEM32\\SCHTASKS.EXE",
    L"\\WINDOWS\\SYSTEM32\\PING.EXE",
    L"\\WINDOWS\\SYSTEM32\\MSPAINT.EXE",
    L"\\WINDOWS\\SYSTEM32\\MSIEXEC.EXE",
    L"\\WINDOWS\\SYSTEM32\\ICACLS.EXE",
    L"\\WINDOWS\\SYSTEM32\\FIND.EXE",

    // SYSWOW64
    L"\\WINDOWS\\SYSWOW64\\REGSVR32.EXE",
    L"\\WINDOWS\\SYSWOW64\\NOTEPAD.EXE",
    L"\\WINDOWS\\SYSWOW64\\RUNONCE.EXE",
    L"\\WINDOWS\\SYSWOW64\\ACLAYERS.DLL",
    L"\\WINDOWS\\SYSWOW64\\UXTHEME.DLL",
    L"\\WINDOWS\\SYSWOW64\\RUNDLL32.EXE",
    L"\\WINDOWS\\SYSWOW64\\TASKKILL.EXE",
    L"\\WINDOWS\\SYSWOW64\\MSIEXEC.EXE",
    L"\\WINDOWS\\SYSWOW64\\CMD.EXE"
};